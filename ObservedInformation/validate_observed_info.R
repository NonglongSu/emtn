
#
t.hat = 0.1997129796996534
aR.hat = 0.3997451633924111
aY.hat = 0.5009421556696639
b.hat = 0.19984862573298465
p = 0.8654266790877216
q = 0.8254006551298637
r = 0.9084850001591495

s = c(1124921.7717664568,1071365.974442619,113317.46341011925,166596.75577039632,523798.03461040894)

t = 0.2
aY = 0.5
aR =0.4
b = 0.2

theta.hat = c(t.hat,aR.hat,aY.hat)
theta = c(t,aR,aY)

B = matrix(0,3,3)
B[1,1] = s[1]/(r**2) + s[3]/((1-r)**2)
B[2,2] = s[2]/(p**2) + s[4]/((1-p)**2)
B[3,3] = s[1]/(q**2) + s[2]/(q**2) + s[3]/(q**2) + s[4]/(q**2) + s[5]/((1-q)**2)

S_2 = matrix(0,3,3)

I = B - S_2

theta_diff = matrix(theta.hat-theta)

x.square = t(theta_diff) %*% I %*% theta_diff

pchisq(x.square,3,lower.tail=FALSE)
